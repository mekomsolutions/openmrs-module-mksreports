SELECT
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Microgynon (plaquette)' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= DATE_SUB(:startDate, INTERVAL 1 MONTH) AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) < 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'New' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as newMycogynonFemaleLT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Microgynon (plaquette)' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= DATE_SUB(:startDate, INTERVAL 1 MONTH) AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) >= 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'New' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as newMycogynonFemaleGT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Microgynon (plaquette)' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= DATE_SUB(:startDate, INTERVAL 1 MONTH) AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) < 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'Existent' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as existentMycogynonFemaleLT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Microgynon (plaquette)' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= DATE_SUB(:startDate, INTERVAL 1 MONTH) AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) >= 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'Existent' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as existentMycogynonFemaleGT25,

count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Microlut (plaquette)' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= DATE_SUB(:startDate, INTERVAL 1 MONTH) AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) < 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'New' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as newMicrolutFemaleLT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Microlut (plaquette)' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= DATE_SUB(:startDate, INTERVAL 1 MONTH) AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) >= 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'New' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as newMicrolutFemaleGT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Microlut (plaquette)' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= DATE_SUB(:startDate, INTERVAL 1 MONTH) AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) < 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'Existent' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as existentMicrolutFemaleLT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Microlut (plaquette)' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= DATE_SUB(:startDate, INTERVAL 1 MONTH) AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) >= 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'Existent' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as existentMicrolutFemaleGT25,

count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Depo Provera Injection' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= DATE_SUB(:startDate, INTERVAL 3 MONTH) AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) < 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'New' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as newDepoFemaleLT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Depo Provera Injection' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= DATE_SUB(:startDate, INTERVAL 3 MONTH) AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) >= 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'New' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as newDepoFemaleGT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Depo Provera Injection' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= DATE_SUB(:startDate, INTERVAL 3 MONTH) AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) < 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'Existent' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as existentDepoFemaleLT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Depo Provera Injection' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= DATE_SUB(:startDate, INTERVAL 3 MONTH) AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) >= 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'Existent' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as existentDepoFemaleGT25,

count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Jadel' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= DATE_SUB(:startDate, INTERVAL 5 YEAR) AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) < 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'New' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as newJadelFemaleLT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Jadel' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= DATE_SUB(:startDate, INTERVAL 5 YEAR) AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) >= 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'New' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as newJadelFemaleGT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Jadel' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= DATE_SUB(:startDate, INTERVAL 5 YEAR) AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) < 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'Existent' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as existentJadelFemaleLT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Jadel' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= DATE_SUB(:startDate, INTERVAL 5 YEAR) AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) >= 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'Existent' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as existentJadelFemaleGT25,

count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Condom (unity)' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= :startDate AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) < 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'New' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as newCondomFemaleLT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Condom (unity)' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= :startDate AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) >= 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'New' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as newCondomFemaleGT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Condom (unity)' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= :startDate AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) < 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'Existent' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as existentCondomFemaleLT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Condom (unity)' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= :startDate AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'F' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) >= 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'Existent' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as existentCondomFemaleGT25,

count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Condom (unity)' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= :startDate AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'M' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) < 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'New' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as newCondomMaleLT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Condom (unity)' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= :startDate AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'M' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) >= 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'New' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as newCondomMaleGT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Condom (unity)' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= :startDate AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'M' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) < 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'Existent' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as existentCondomMaleLT25,
count(if( concept_id=(select DISTINCT concept_id from concept_name where name = 'FP administred' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && value_coded=(select DISTINCT concept_id from concept_name where name = 'Condom (unity)' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) && obs_group_id IN (select obs_group_id from obs where obs_group_id IN (SELECT obs_id FROM obs where obs_datetime >= :startDate AND obs_datetime <= :endDate AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Family Planning' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) AND person.gender = 'M' AND round(DATEDIFF(obs.obs_datetime, person.birthdate)/365.25, 1) >= 25 AND concept_id=(select DISTINCT concept_id from concept_name where name = 'Type of user' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0) AND value_coded=(select DISTINCT concept_id from concept_name where name = 'Existent' and locale='en' and concept_name_type='FULLY_SPECIFIED' and voided = 0)) ,1,null)) as existentCondomMaleGT25
from obs inner join person ON obs.person_id=person.person_id where obs.voided = 0 ;



